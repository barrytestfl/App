<html lang="en">

<head>
<style>
    #printArea table.print-friendly tr td, #printArea table.print-friendly tr th {
        page-break-inside: avoid;
    }
    * {
        box-sizing: border-box;
    }

    body {
        padding: 0;
        margin: 0;
        font-family: 'Open Sans', sans-serif;
    }

    main {
        padding: 1rem;
        margin: auto;
    }

    .main-header {
        width: 100%;
        height: 3.5rem;
        padding: 0 1.5rem;
    }

    .main-header__nav {
        height: 100%;
        display: flex;
        align-items: center;
    }

    .main-header__item-list {
        list-style: none;
        margin: 0;
        padding: 0;
        display: flex;
    }

    .main-header__item {
        margin: 0 1rem;
        padding: 0;
    }

        .main-header__item a {
            text-decoration: none;
            font-size: 18px;
            font-weight: bold;
            color: purple;
        }

            .main-header__item a:hover,
            .main-header__item a:active,
            .main-header__item a.active {
                color: #077a0c;
            }

    .grid {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-around;
        align-items: stretch;
    }

    .card {
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.26);
    }

    .card__header,
    .card__content {
        padding: 1rem;
    }

        .card__header h1,
        .card__content h1,
        .card__content h2,
        .card__content p {
            margin: 0;
        }

    .card__image {
        width: 100%;
    }

        .card__image img {
            width: 100%;
        }

    .card__actions {
        padding: 1rem;
        text-align: center;
    }

        .card__actions button,
        .card__actions a {
            margin: 0 0.25rem;
        }

    .btn {
        font: inherit;
        
        font-size: 16px;
        border: 1px solid #00695c;
        color: #00695c;
        background: white;
        border-radius: 3px;
        cursor: pointer;
    }

        .btn:hover,
        .btn:active {
            background-color: #00695c;
            color: white;
        }

    .first-container {
        display: grid;
        grid-template-columns: 30% 70%;
        padding: 3px;
    }

    .first-item {
        padding: 3px;
    }

    .link-container {
        display: grid;
        grid-template-columns: 30% 30% 30%;
        padding: 3px;
    }

    #smartBTNcvs {
        background-image: url( '../cvs_logo.png' );
        background-size: 140px 90px;
        height: 90px;
        width: 140px;
    }

        #smartBTNcvs img {
            display: block;
            height: 90px;
            width: 140px;
        }

    #smartBTNalbert {
        background-image: url( '../albertsons_logo.png' );
        background-size: 140px 90px;
        height: 90px;
        width: 140px;
    }

        #smartBTNalbert img {
            display: block;
            height: 90px;
            width: 140px;
        }

    #smartBTNeleven {
        background-image: url( '../7eleven_logo.png' );
        background-size: 140px 90px;
        height: 90px;
        width: 140px;
    }

        #smartBTNeleven img {
            display: block;
            height: 90px;
            width: 140px;
        }

    #smartBTNny {
        background-image: url( '../NY_logo.png' );
        background-size: 140px 90px;
        height: 90px;
        width: 140px;
    }

        #smartBTNny img {
            display: block;
            height: 90px;
            width: 140px;
        }

    #smartBTNpa1 {
        background-image: url( '../penn.png' );
        background-size: 140px 90px;
        height: 90px;
        width: 140px;
    }

    #smartBTNpa img {
        display: block;
        height: 90px;
        width: 140px;
    }

    #smartBTNgeneral {
        background-image: url( '../oes_logo.png' );
        background-size: 140px 90px;
        height: 90px;
        width: 140px;
    }

        #smartBTNgeneral img {
            display: block;
            height: 90px;
            width: 140px;
        }

    .centerIMG {
        display: block;
        margin-left: auto;
        margin-right: auto;
        width: 50%;
    }


    #paint {
        border: 1px solid black;
        background: #333333;
        margin-left: auto;
        margin-right: auto;
        display: block;
    }

    

    .nc {
        width: 45%;
        height: 30%;
        max-width: 450%;
        max-height: 40%;
    }
 
    #phone1, #customerID, #date, #wodate, #busName, #rep, #email, #address, #city, #state, #zip, #phone, #contact, #instalTime, #qty {
        width: 80%;
        max-width: 90%;
        
    }
    #caption2 {
        width: 100%;
        font-size: 22px;
        justify-content: center;
        text-align: left;
        font-weight: bold;
        padding: 12px;
    }
    #caption1 {
        width: 100%;
        display: flex;
        background-image: linear-gradient(to bottom left, white, white, orange);
        flex-direction: column;
        justify-content: center;
        text-align: center;
        border-radius: 10px;
        border-style: solid;
    }

        #caption1 p1 {
            font-size: 22px;
            color: orange;
            font-weight: bold;
        }

        #caption1 p2 {
            font-size: 22px;
            color: orangered;
        }

    #caption {
        max-height: 110px;
        width: 100%;
        background: #fc9d03;
        display: flex;
        flex-direction: column;
        justify-content: center;
        text-align: center;
        border-radius: 10px;
    }

    #input {
        width: 20%;
        max-width: 85%;
        max-height: 30%;
    }

    #al, #rl {
        width: 95%;
        max-width: 95%;
        max-height: 30%;
    }

    .info-container {
        display: grid;
        grid-template-columns: 25% 25% 25% 25%;
        background-color: #fc9d03;
        padding: 3px;
        border-radius: 10px;
    }

    .info-item {
        background-color: rgba(255, 255, 255, 0.8);
        border: 1px solid rgba(0, 0, 0, 0.8);
        padding: 5px;
        font-size: 12px;
        text-align: left;
        max-height: 90px;
    }

    .grid-container {
        display: grid;
        grid-template-columns: 16% 9% 45% 10% 10% 10%;
        background-color: #fc9d03;
        padding: 3px;
        border-radius: 4px;
        border-style: groove;
    }

    .grid-item {
        background-color: rgba(255, 255, 255, 0.8);
        border: 1px solid rgba(0, 0, 0, 0.8);
        padding: 3px;
        font-size: 12px;
        text-align: left;
    }

    .line-container {
        display: grid;
        grid-template-columns: 50% 50%;
        padding: 3px;
    }

    .line-item {
        background-color: rgba(255, 255, 255, 0.6);
        border: 1px solid rgba(0, 0, 0, 0.8);
        padding: 2px;
        font-size: 12px;
        text-align: left;
    }

    .gasketline-container {
        display: grid;
        grid-template-columns: 30% 30% 30%;
        padding: 1px;
    }

    .gasketline-item {
        padding: 5px;
        font-size: 12px;
        text-align: left;
    }

    .light-container {
        display: grid;
        grid-template-columns: 50% 50%;
        background-color: #fc9d03;
        padding: 1px;
        border-radius: 3px;
        border-style: groove;
    }

    .light-item {
        background-color: rgba(255, 255, 255, 0.8);
        border: 1px solid rgba(0, 0, 0, 0.8);
        padding: 2px;
        font-size: 12px;
        text-align: left;
    }

    div.ex1 {
        width: 200px;
        height: 80px;
        margin: auto;
        border: 3px solid #73AD21;
    }

    .declair {
        font-size: 9px;
        font-weight: bold;
        margin: 0;
        padding: 1px;
    }

    .customer-info-container {
        display: grid;
        grid-template-columns: 30% 30% 30%;
        padding: 3px;
    }

    .customer-info-item {
        background-color: rgba(255, 255, 255, 0.8);
        font-weight: bold;
        padding: 5px;
        font-size: 12px;
        text-align: left;
    }

    
    .nc {
        width: 45%;
        height: 30%;
        max-width: 450%;
        max-height: 40%;
    }


    #al, #rl {
        width: 95%;
        max-width: 95%;
        max-height: 30%;
    }

   #printArea table {
        font-family: arial, sans-serif;
        font-size: 13.0px;
        border-collapse: collapse;
        width: 95%;
        max-width: 95%;
        break-inside: avoid;
    }

    #printArea td, #printArea th {
        border: 1px solid #ebbf49;
        border-bottom: 2px solid #ebbf49;
        text-align: top left;
        padding: 5px;
        break-inside: avoid;
    }

    #printArea tr:nth-child(even) {
        background-color: #fadb87;
    }

    .top_row {
        display: table;
        width: 100%;
    }

        .top_row > div {
            display: table-cell;
            width: 50%;
            border-bottom: 1px solid black;
        }
    .navbutton {
        background-color: #4CAF50; /* Green */
        border: none;
        color: white;
        padding: 15px 32px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin: 4px 2px;
        cursor: pointer;
    }

    .navbutton1 {
        margin: 0;
        position: absolute;
        top: 50%;
        left: 50%;
        -ms-transform: translate(-50%, -50%);
        transform: translate(-50%, -50%);
        align-self: center;
        background-color: #fc9d03;
        width: 30%;
        color: black;
        border: 2px solid #4CAF50;
    }
    .navbutton2 {
        margin: 0;
        position: absolute;
        top: 90%;
        left: 50%;
        -ms-transform: translate(-50%, -50%);
        transform: translate(-50%, -50%);
        
        background-color: #fc9d03;
        width: 30%;
        color: black;
        border: 2px solid #4CAF50;
    }
    .loadBTN {
        position: relative;
    }
    /*-------------------------*/
    .nav-input {
        float: right;
        align-content: center;
        font-size: 12px;
        color: black;
        text-align: center;
        padding: 3px;
        text-decoration: none;
        margin-top: 8px;
    }
    .nav-span {
        float: right;
        font-size: 12px;
        color: white;
        text-align: center;
        padding: 3px;
        text-decoration: none;
        margin-top: 8px;
    }
    .navbar {
        overflow: hidden;
        background-color: #fc9d03;
        align-items: center;
        align-content: center;
        border: 2px solid #4CAF50;
    }

        .navbar a{
            float: left;
            font-size: 16px;
            color: white;
            text-align: center;
            padding: 14px 16px;
            text-decoration: none;
        }
        .navbar input, span {
            align-items: center;
            text-align: center;
            align-content: center;
        }
            .navbar a:hover, a:active .dropbtn {
                background-color: red;
            }

 /*-------------------------*/

</style>

    <meta name="viewport" content="width=device-width, initial-scale=1">
	 <script type="text/javascript" src="https://code.jquery.com/jquery-3.1.0.min.js"></script>
    	 <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.2.60/jspdf.min.js"></script>
 <script type="text/javascript" src="https://html2canvas.hertzen.com/dist/html2canvas.js"></script>
	
    <!-- Angular Material requires Angular.js Libraries -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.7.6/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.7.6/angular-animate.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.7.6/angular-aria.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.7.6/angular-messages.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/angular-material-icons/0.7.1/angular-material-icons.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/SVG-Morpheus/0.1.8/svg-morpheus.js"></script>



    <script src="https://rawgit.com/daniel-nagy/md-data-table/master/dist/md-data-table.js"></script>
    <link rel="stylesheet" href="https://rawgit.com/daniel-nagy/md-data-table/master/dist/md-data-table.css">

    <!-- Angular Material Library -->
    <script src="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.12/angular-material.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>    
    <!-- Angular Material style sheet -->
    <link rel="stylesheet"         href="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.12/angular-material.min.css">
	
	
	
       <style>
	   .md-icon-button+.md-datepicker-input-container {
    margin-left: 12px;
    width: 79%;
}
md-input-container{width:100%!important}
	   </style>
	
	 
</head>

<body layout="row" ng-app="StarterApp" ng-cloak ng-controller="AppCtrl">
 
 <input type='file' id="file" class="navbutton1" accept='text/plain' onchange="angular.element(this).scope().openFile(event)" hidden > 
  <div id='output' ng-model="woToLoad" hidden></div>             
    <div layout="column" class="relative" layout-fill role="main">
        <md-toolbar ng-show="!showSearch" class="hide-print">
            <div class="md-toolbar-tools">
				<h5>  ORANGE ENERGIZING SOLUTIONS </h5>
                <span flex></span>
 
<md-menu class="hide-print">
      <md-button aria-label="Open phone interactions menu" class="md-icon-button hide-print" ng-click="openMenu($mdMenu, $event)">
        <ng-md-icon icon="more_vert"></ng-md-icon>
      </md-button>
      <md-menu-content width="4" class="hide-print">
	  <md-menu-item>		
          <md-button ng-click="newWoPage($event)">
            <md-icon icon="open-file">  <ng-md-icon icon="add"></ng-md-icon> </md-icon>
           New 
          </md-button>
        </md-menu-item>	
		 <md-menu-divider></md-menu-divider>
	  <md-menu-item>
          <md-button ng-click="Open($event)">
            <md-icon icon="open-file">  <ng-md-icon icon="book"></ng-md-icon> </md-icon>
           Open File
          </md-button>
        </md-menu-item>
        <md-menu-item>		
          <md-button  ng-click="showPrompt($event)">
            <md-icon icon="open-file">  <ng-md-icon icon="save"></ng-md-icon> </md-icon>
           Save File
          </md-button>
        </md-menu-item>
        
        <md-menu-divider></md-menu-divider>
		 <md-menu-item   >		
          <md-button ng-click="printPrivewPage()" ng-disabled="data.selectedIndex==0" >
            <md-icon icon="open-file">  <ng-md-icon icon="aspect_ratio"></ng-md-icon> </md-icon>
           Print Previw
          </md-button>
        </md-menu-item>
		
         <md-menu-item   >		
          <md-button ng-click="printPage()" ng-disabled="data.selectedIndex==0" >
            <md-icon icon="open-file">  <ng-md-icon icon="print"></ng-md-icon> </md-icon>
           Print
          </md-button>
        </md-menu-item>
		 <md-menu-divider></md-menu-divider>
         <md-menu-item >		
          <md-button ng-click="SignInSVG()"  ng-disabled="data.selectedIndex==0">
            <md-icon icon="open-file">  <ng-md-icon icon="edit"></ng-md-icon> </md-icon>
					Get Signature
          </md-button>
        </md-menu-item>
		
		
		
      </md-menu-content>
</md-menu>

				</div>
            <md-tabs md-stretch-tabs class="md-primary" md-selected="data.selectedIndex">
                <md-tab id="tab1" aria-controls="tab1-content">
                   Work-Order
                </md-tab>
                <md-tab id="tab2" aria-controls="tab2-content">
                    PREVIEW   
                </md-tab>
            </md-tabs>
        </md-toolbar>

        <md-content flex md-scroll-y>
            <ui-view layout-fill layout-padding>

                <ng-switch on="data.selectedIndex" class="tabpanel-container">
                    <div role="tabpanel" id="tab1-content" aria-labelledby="tab1" ng-switch-when="0"
                        md-swipe-left="next()" md-swipe-right="previous()" layout-align="center center"
                        layout-xs="column" layout="row">
                        <md-card flex-gt-sm="90" flex-gt-md="80" layout-padding>
                             
                                <h2>REP</h2>
                                <div class="layout-sm-column layout-row" layout-xs="column" layout="row" layout-padding>
                                    <md-input-container flex-gt-sm="100" flex-gt-md="50">
                                        <input placeholder="Full Name" ng-change="ChangeuserName(userName)"  type="text" name="userName" id="userName" aria-label="primary" ng-model="userName" />
                                    </md-input-container>
                                    <md-input-container flex-gt-sm="100" flex-gt-md="50">
                                        <input placeholder="Phone" type="text"  ng-change="ChangeuserPhone(userPhone)"  aria-label="primary" ng-model="userPhone" />
                                    </md-input-container>
                                    <md-input-container flex-gt-sm="100" flex-gt-md="50">
                                        <input placeholder="Email" type="email"  ng-change="ChangeuserEmail(userEmail)" aria-label="primary" ng-model="userEmail" />
                                    </md-input-container>



                                </div>
                                <!-- --------------------------------  -->


				  <div class="info-item">
                    <p> Sales Rep : {{ userName }}</p>
                    <p>Rep phone: {{ userPhone }} </p>
                    <p>Rep Email: {{ userEmail }}  </p>
					<input type="text" id="repName" name="repName" ng-model="userName" hidden />                 
                    
                    <input type="text" id="repPhone" name="repPhone" style="width: 50%" placeholder="Phone" hidden /><br />
                    <input type="text" id="repEmail" name="repEmail" style="width: 50%" placeholder="Email"   hidden />

                </div>

 <div    >
                                    <div    layout-padding  >                                         
                                            <div  class="layout-sm-column layout-row" layout-xs="column" layout="row" layout-padding  >
                                                <input type="text" id="fn" name="fn" value="setFN" ng-model="setFN"  hidden />
                                                <md-input-container flex-gt-sm="100" flex-gt-md="50"  >
                                                    <input type="text" placeholder="Business Name"
                                                        ng-model="f_info.bv_name" id="busName"
                                                        ng-change="makeFileName()" name="busName" required />
                                                </md-input-container>
                                                <md-datepicker   flex-gt-sm="100" flex-gt-md="100"     ng-model="f_info.fv_date" id="wodate" name="fv_date" input-aria-labelledby="datepicker-header" md-placeholder="Date" input-aria-describedby="datepicker-description"  ></md-datepicker>
                                               
                                            </div>
                                          <div    layout-xs="column" layout="column"  >
                                                <md-input-container  class="md-block" flex-gt-sm="50" flex-gt-md="100">
                                                    <input type="text" id="address" placeholder="Address" ng-model="f_info.bv_address" ng-change="makeFileName()"   name="address" required />
                                                </md-input-container>
                                            </div>
                                            <div  class="layout-sm-column layout-row" layout-xs="column" layout="row" layout-padding >
                                        
                                                <md-input-container  flex-gt-sm="50" flex-gt-md="100">
                                                    <input type="text" placeholder="City" id="city" name="city"
                                                        size="15" ng-model="f_info.bv_city" />
                                                </md-input-container>
                                                <md-input-container  flex-gt-sm="50" flex-gt-md="100" class="md-block">
                                                    <input type="text" placeholder="State" id="state" name="state"
                                                        size="2" ng-model="f_info.bv_state" />
                                                </md-input-container>
                                                <md-input-container  flex-gt-sm="50" flex-gt-md="100" class="md-block">
                                                    <input type="text" placeholder="Zip" id="zip" name="zip" size="5"
                                                        ng-model="f_info.bv_zip" />
                                                </md-input-container>
                                            </div>
                                            <div  class="layout-sm-column layout-row" layout-xs="column" layout="row" layout-padding >
                                        
                                                <md-input-container flex-gt-sm="100" flex-gt-md="50">
                                                    <input type="text" placeholder="Contact" id="contact" name="contact"
                                                        ng-model="f_info.bv_contact" /><br /><br />
                                                </md-input-container>
                                                <md-input-container  flex-gt-sm="100" flex-gt-md="50">
                                                    <input type="text" placeholder="Title" id="contactTitle"
                                                        name="contactTitle" ng-model="f_info.bv_title" />
                                                </md-input-container>
                                                <md-input-container class="md-block" flex-gt-sm="30">
                                                    <input type="text" placeholder="Phone" id="phone" name="phone"
                                                        ng-model="f_info.bv_phone" />
                                                </md-input-container>
                                                <md-input-container class="md-block" flex-gt-sm="30">
                                                    <input type="text" placeholder="Email" id="email" name="email"
                                                        ng-model="f_info.bv_email" />
                                                </md-input-container>
                                            </div>
                                            <div  class="layout-sm-column layout-row" layout-xs="column" layout="row" layout-padding >
                                         
                                                <md-input-container class="md-block" flex-gt-sm="100">

                                                    <textarea id="custNote" placeholder="Note" name="custNote"
                                                        ng-model="f_info.fv_notes" md-maxlength="150" rows="2"
                                                        md-select-on-focus>
                                                    </textarea>
                                                </md-input-container>
												</div>
                                      </div>


    <div   name="masterInfoDiv" ng-repeat="line in lineArr" >
      
 
    <div  layout="column"  layout-padding
 ng-style="$index%2==0 && {'border':'2px solid green'} "
 style="border:1px solid orange"
	>
  
	<div class="layout-row" layout-xs="row" layout="row"   > 		
          
            <md-select    flex-gt-sm="100" flex-gt-md="50" style="margin-bottom:46px;padding-right:5px;"  ng-model="line.name">
                <md-option id="ash" name="{{ line.typeChs}}" ng-model="line.name" value="Ash">  ASH</md-option>
                <md-option id="gasket" name="{{ line.typeChs}}" ng-model="line.name" value="Gasket">  Gasket</md-option>
                <md-option id="closer" name="{{ line.typeChs}}" ng-model="line.name" value="Closer">    Door Closer</md-option>
                <md-option id="curtain" name="{{ line.typeChs}}" ng-model="line.name" value="Curtain">   Strip Curtain</md-option>
                <md-option id="nc" name="{{ line.typeChs}}" ng-model="line.name" value="NC">  Night Cover</md-option>
                <md-option id="light" name="{{ line.typeChs}}" ng-model="line.name" value="Light">   Lights</md-option>
          </md-select>
		 
    <md-input-container   flex-gt-sm="100" flex-gt-md="50" >
                <input type="number" placeholder="QTY" id="{{ line.idqty }}" style="width:85%;" placeholder="QTY"   ng-model="line.idqty" ng-change="makeTotalPrice(line)" />
            </md-input-container>
       <md-input-container    flex-gt-sm="100" flex-gt-md="50">
                <input type="number" placeholder="Price" ng-model="line.vuPrice" id="{{ line.idLinePrice }}"        name="{{ line.idLinePrice }}"  ng-change="makeTotalPrice(line)" />
            </md-input-container>            
             
		
</div>
                  
		   <md-input-container flex-gt-sm="100" flex-gt-md="100">
                <textarea ng-model="line.vuNote" placeholder="Note" id="{{ line.idLineNote }}"    name="{{ line.idLineNote }}" style="word-break: break-word;">{{ line.vuNote }}</textarea>
            </md-input-container>
            <div   ng-if="line.name==='Light'?true:false"     layout="column" >
               
                  <div  layout="row">
                        <md-input-container flex-gt-sm="100" flex-gt-md=="50">
                            <label>Existing Fixture</label>
                            <md-select ng-model="line.vuExFxTy">
                                <md-option ng-repeat="opt in lightOpt" ng-value="opt"> {{opt}}</md-option>
                            </md-select>
                        </md-input-container>
                        <md-input-container flex-gt-sm="100" flex-gt-md=="50">

                            <label>Existing light type</label>
                            <md-select ng-model="line.vuExLtTy">
                                <md-option ng-repeat="opt in returnLtArray(line.vuExFxTy)" ng-value="opt"> {{opt}}
                                </md-option>
                            </md-select>

                        </md-input-container>
                        <md-input-container flex-gt-sm="100" flex-gt-md=="50">
                            <label>No. of light in a fixture</label>
                            <md-select ng-model="line.vuNOL">
                                <md-option ng-repeat="opt in ['1', '2', '3', '4']" ng-value="opt"> {{opt}}</md-option>
                            </md-select>
                        </md-input-container>
					 </div>
					<div  layout="row">
                     <md-input-container flex="50">
                            <label> New Fixture</label>
                            <md-select ng-model="line.vuNwFxTy">
                                <md-option ng-repeat="opt in lightOpt" ng-value="opt"> {{opt}}</md-option>
                            </md-select>
                        </md-input-container>
                        <md-input-container flex="50">
                            <label> New Fixture Type</label>
                            <md-select ng-model="line.vuNwLtTy">
                                <md-option ng-repeat="opt in returnNwLtArray(line.vuNwFxTy)" ng-value="opt"> {{opt}}
                                </md-option>
                            </md-select>
                        </md-input-container>
  
                        <md-input-container flex="50">
                            <label> Color ct</label>
                            <md-select ng-model="line.vuColor">
                                <md-option ng-repeat="opt in ['5000K', '4000K', '3000K']" ng-value="opt"> {{opt}}
                                </md-option>
                            </md-select>
                        </md-input-container>
                   
                        <md-input-container flex="50">
                            <label>Type</label>
                            <md-select ng-model="line.vuType">
                                <md-option ng-repeat="opt in ['Fixture', 'Retrofit', 'Lamp']" ng-value="opt"> {{opt}}
                                </md-option>
                            </md-select>
                        </md-input-container>
                     </div>
					<div  layout="row">
                    <md-input-container class="md-block" flex="50">
                        <input type="text" placeholder="Current wattage" ng-model="line.vuCurWt"
                            id="{{ line.id_CurWt }}" name="{{ line.id_CurWt }}"  
                            placeholder="Current wattage" value="{{ line.vuCurWt }}" />
                    </md-input-container>
                    <md-input-container class="md-block" flex="50">
                        <input type="text" placeholder="New Wattage" ng-model="line.vuNewWt" id="{{ line.id_NewWt }}"
                            name="{{ line.id_NewWt }}"   placeholder="New Wattage"
                            value="{{ line.vuNewWt }}" />
                    </md-input-container>
                    <md-input-container class="md-block" flex="50">
                        <input type="text" placeholder="# Working lights" ng-model="line.vuWorkLt"
                            id="{{ line.id_WorkLt }}" name="{{ line.id_WorkLt }}"  
                            placeholder="# Working lights" value="{{ line.vuWorkLt }}" />
                    </md-input-container>
                    <md-input-container class="md-block" flex="50">
                        <input type="text" placeholder="Fixtures height" ng-model="line.vuFxHigh"
                            id="{{ line.id_FxHigh }}" name="{{ line.id_FxHigh }}"  
                            placeholder="Fixtures height" value="{{ line.vuFxHigh }}" />
                    </md-input-container>
 </div>
					 
            </div>
            <div   ng-if="line.name==='Gasket'?true:false"  class="layout-sm-column layout-row" layout-xs="column" layout="row"  >
 <div  layout="column" style="width:100%!important"  >				
				<div   layout="row"    >                
									<md-input-container    layout="column" >
										<input type="text" placeholder="Style" id="{{ line.idstyle }}" name="{{ line.idstyle }}"
											 ng-model="line.vuStyle" />
									</md-input-container>
									<md-input-container    layout="column"   >
										<input type="text" placeholder="Width" id="{{ line.idwidth }}" name="{{ line.idwidth }}"
											 ng-model="line.vuWidth" />
									</md-input-container>
									<md-input-container  layout="column"   >
										<input type="text" placeholder="Height" id="{{ line.idhigh}}" name="{{ line.idhigh}}"
											  ng-model="line.vuHigh" />
									</md-input-container>
								 
				</div>   
					
					<div     layout="column"     >        				
						<md-radio-group ng-model="line.sidesG"  layout="row"   >
								<md-radio-button id="4s" name="{{ line.sidesG }}" flex="50" ng-model="line.vuSides" value="4 sides">4 Sides</md-radio-button>
								<md-radio-button id="3s" name="{{ line.sidesG }}" flex="50" ng-model="line.vuSides" value="3 sides">3 Sides</md-radio-button>
							</md-radio-group>
							 <br/>
							<md-radio-group ng-model="line.gclFr"  layout="row"  flex-gt-sm="100" flex-gt-md="100">
								<md-radio-button id="cooler" name="{{ line.gclFr}}"  flex="50"ng-model="line.vuCool" value="cooler">	Cooler</md-radio-button>
								<md-radio-button id="freezer" name="{{ line.gclFr}}" flex="50" ng-model="line.vuCool" value="freezer">Freezer</md-radio-button>
							</md-radio-group>
							 <br/>
							<md-radio-group ng-model="line.id_RiWi" layout="row" flex-gt-sm="100" flex-gt-md="100"   >
								<md-radio-button id="RI" name="{{ line.id_RiWi }}" flex="50" ng-model="line.vuRiWi" value="Reach-in">	Reach-in</md-radio-button>
								<md-radio-button id="WI" name="{{ line.id_RiWi }}" flex="50" ng-model="line.vuRiWi" value="Walk-in">Walk-in</md-radio-button>
							</md-radio-group> 
						</div>
      
</div>
	  </div>
            <div   ng-if="line.name==='Curtain'?true:false"  class="layout-sm-column layout-row" layout-xs="column" layout="row" >
<div layout="row">

                <md-input-container class="md-block" flex-gt-sm="100" flex-gt-md="50">
                    <input type="text" placeholder="Width" id="{{ line.idwidth }}" name="{{ line.idwidth }}"
                          ng-model="line.vuWidth" />
                </md-input-container>
                <md-input-container class="md-block"flex-gt-sm="100" flex-gt-md="50">
                    <input type="text" placeholder="Height" id="{{ line.idhigh}}" name="{{ line.idhigh}}"
                   ng-model="line.vuHigh" />
                </md-input-container>
</div>
                <md-radio-group ng-model="line.cclFr">
                    <md-radio-button id="cooler" flex="50" name="{{ line.cclFr }}" ng-model="line.vuCool" value="cooler"> Cooler
                    </md-radio-button>
                    <md-radio-button id="freezer"  flex="50" name="{{ line.cclFr }}" ng-model="line.vuCool" value="freezer">
                        Freezer</md-radio-button>
                </md-radio-group>

            </div>
            <div   ng-if="line.name==='Closer'?true:false"  class="layout-sm-column layout-row" layout-xs="column" layout="row" >
                
                    <md-radio-group ng-model="line.rclFr" layout="column">
                        <md-radio-button flex="50" id="cooler" name="{{ line.rclFr}}" ng-model="line.vuCool" value="cooler"> Walk-In Cooler</md-radio-button>
                        <md-radio-button flex="50" id="freezer" name="{{ line.rclFr}}" ng-model="line.vuCool" value="freezer">  Walk-In Freezer</md-radio-button>
                    </md-radio-group>

                    <md-radio-group ng-model="line.threeFour"  layout="column">
                        <md-radio-button flex="50"  id="4s" name="{{ line.threeFour }}" ng-model="line.vuSides"  value="1094 (Regular)"> 1094 (Regular)</md-radio-button>
                        <md-radio-button flex="50"  id="3s" name="{{ line.threeFour }}" ng-model="line.vuSides"  value="1097 (Large)"> 1097 (Large)</md-radio-button>
                    </md-radio-group>
 
            </div>
            <div   ng-if="line.name==='NC'?true:false"  class="layout-sm-column layout-row" layout-xs="column" layout="row" >
                 

                    <md-radio-group ng-model="line.threeFour" layout-xs="row" layout="column">
                        <md-radio-button id="4s" flex="50" name="{{ line.threeFour }}" ng-model="line.vuSides" value="4 ft"> 4 ft
                        </md-radio-button>
                        <md-radio-button id="3s" flex="50" name="{{ line.threeFour }}" ng-model="line.vuSides" value="3 ft">3 ft
                        </md-radio-button>
                    </md-radio-group>
<br/>
<br/>
                    <md-radio-group ng-model="line.nclFr"  layout-xs="row" layout="column">
                        <md-radio-button id="cooler" flex="50" name="{{ line.nclFr }}" ng-model="line.vuCool" value="cooler">
                            Cooler</md-radio-button>
                        <md-radio-button id="freezer" flex="50" name="{{ line.nclFr }}" ng-model="line.vuCool" value="freezer">
                            Freezer</md-radio-button>
                    </md-radio-group>

 
            </div>
            <div   ng-if="line.name==='Ash'?true:false"  class="layout-sm-column layout-row" layout-xs="column" layout="row"  >

				<div layout="column">
				<div layout="row">
				<md-input-container layout="column">
					<input type="text" placeholder="Number Of Doors" id="{{ line.idashNodoors}}" name="{{ line.idashNodoors}}" ng-model="line.vuAsh" />
				</md-input-container>
				<md-input-container  layout="column">
					<input type="text" placeholder="AMP" id="{{ line.id_Amp }}" name="{{ line.id_Amp }}" ng-model="line.vuAmp"   />
				</md-input-container>
				
				</div>
				<div>
				<md-radio-group ng-model="line.aclFr" layout="row"  >
						<md-radio-button flex="50" id="cooler" name="{{ line.aclFr }}" ng-model="line.vuCool" value="cooler">	Cooler</md-radio-button>
						<md-radio-button flex="50" id="freezer" name="{{ line.aclFr }}" ng-model="line.vuCool" value="freezer">Freezer</md-radio-button>
				</md-radio-group>
				<br/>
				<md-radio-group ng-model="line.sidesG" layout="row">
						<md-radio-button flex="50" id="4s" name="{{ line.sidesG }}" ng-model="line.vuSides" value="110V"> 110V</md-radio-button>
						<md-radio-button flex="50" id="3s" name="{{ line.sidesG }}" ng-model="line.vuSides" value="220V"> 220V</md-radio-button>
				</md-radio-group>
				
				</div>
				</div>
				
				


            </div>
        <br/>
      <br/>
    <md-content class="layout-row" layout-xs="row" layout="row">
			 
			<md-button  flex="50"    class="md-warn  md-hue-1"  >
               {{ line.setTotalPrice }}
            </md-button>
           <md-button  flex="50"    class="md-warn  md-hue-1 " aria-label="Add" ng-click="addLine($index)">
                <ng-md-icon icon="add"></ng-md-icon>
            </md-button>
            <md-button  flex="50"   class="md-warn  md-hue-2 md-accent" aria-label="Remove" ng-click="removeLine($index)">
                <ng-md-icon icon="delete"></ng-md-icon>
            </md-button>
		 
        </md-content>
        
      <br/>
      <br/>
      <br/>
                     
        </div>
        
    
    </div>
	</div>
	<!-- end of add wo page div-->


    </md-card-content>
						</md-card>
    </div>
    <div role="tabpanel" id="tab2-content" aria-labelledby="tab2" ng-switch-when="1" md-swipe-left="next()"
        md-swipe-right="previous()" layout="row" layout-align="center center">
        <md-card flex-gt-sm="90" flex-gt-md="80">
            <md-card-content>
               
 <div  id="printArea" ng-init="InitPage()" >
            <div id="caption1">
                <div style="position:absolute;left:85%;top:2%">

                </div>
                <br />
                <p1 style="text-align: center;">ORANGE ENERGIZING SOLUTIONS</p1>
                <p2 style="text-align: center;">909 3rd Ave #7317,New York, NY 10150 |Phone: (718) 682-3618</p2>
                <a HREF="http://www.oesolutions.net/">www.oesolutions.net | info@oesolutions</a>



            </div>
            <br />
            <!-- form and customer infor -->
            <div class="customer-info-container">
                <div class="customer-info-item">
                  <p>  Business Name: {{ f_info.bv_name }}</p>

                </div>
                <div class="customer-info-item">
                    <p>Date:  {{ f_info.fv_date}}</p>
                    
                </div>
                <div class="customer-info-item">
                   <p> Rep:  {{userName}}   </p>
                   <p> Phone:  {{userPhone}}</p>  
                   <p> Email:  {{userEmail}}</p>
                </div>


                <div class="customer-info-item">
                   <p> Address:  {{ f_info.bv_address }}</p>
                </div>
                <div class="customer-info-item">
                  <p>  City, State, Zip:  {{ f_info.bv_city }},  {{ f_info.bv_state }},  {{ f_info.bv_zip }}</p>
                </div>
                <div class="customer-info-item">
                    <br />
                </div>


                <div class="customer-info-item">
                   <p> Contact:  {{ f_info.bv_contact }}<br />
                    Title:  {{ f_info.bv_title }}
					</p>
                </div>
                <div class="customer-info-item">
                    <p>Phone:  {{ f_info.bv_phone }}</p>
                </div>
                <div class="customer-info-item">
                  <p>  E-mail:  {{ f_info.bv_email }}</p>
                </div>



                <div class="customer-info-item">
                </div>
                <div class="customer-info-item">
                  <p>  Notes:  {{ f_info.fv_notes }}</p>
                </div>

            </div>
            <!-- ------------------------- -->

            <div id="lightTable" class="print-friendly">
             
<br/>   
			<h3 ng-if="itemQty.Light>0" style="text-align:left;"> Lights </h3>
 <br/> 
                <table ng-if="itemQty.Light>0">
                    <!-- <caption id="caption2">Lights</caption> -->
                    <tr>
                        <th>QTY</th>

                        <th>Installing</th>
                        <th>Existing</th>
                        <th>Fix/Retro/Lamp</th>
                        <th># working Fixtures</th>

                        <th>Notes</th>
                        <th>Price</th>
                        <th>Total</th>
                    </tr>


                    <tr ng-repeat="line in lineArr" ng-if="lineArr[$index].name=='Light'">


                        <td>{{ lineArr[$index].idqty }}</td>

                        <td>
                            {{ lineArr[$index].vuNwFxTy }} , {{ lineArr[$index].vuNewWt }}w, {{ lineArr[$index].vuNwLtTy }}, {{ lineArr[$index].vuColor }}
                        </td>
                        <td>
                            Replacing {{ lineArr[$index].vuExFxTy }} {{ lineArr[$index].vuCurWt }}w, {{ lineArr[$index].vuExLtTy  }}, {{ lineArr[$index].vuNOL  }} light per fixture.
                        </td>
                        <td ng-if="lineArr[$index].vuType==='Retrofit'?true:false">This is a Retrofit</td>
                        <td ng-if="lineArr[$index].vuType==='Fixture'?true:false">This is a Fixture</td>
                        <td ng-if="lineArr[$index].vuType==='Lamp'?true:false">This is a Lamp</td>

                        <td ng-if="lineArr[$index].vuWorkLt==lineArr[$index].idqty?true:false">All lights / Fixtures are working</td>
                        <td ng-if="lineArr[$index].vuWorkLt==lineArr[$index].idqty?false:true">There are {{ lineArr[$index].vuWorkLt  }} Working lights / Fixtures out of {{ lineArr[$index].idqty }}.</td>

                        <td>{{ lineArr[$index].vuNote }}</td>
                        <td>${{ lineArr[$index].vuPrice }}</td>
                        <td>${{ lineArr[$index].vuPrice*lineArr[$index].idqty }}</td>

                    </tr>
                </table>
            </div>
            <!-- ---------------- ASH ------------------ -->
            <div id="ashTable">
        
<br/>         
        <h3 ng-if="itemQty.Ash>0" style="text-align:left;"> ASH Controls </h3>
        
<br/>   
                <table ng-if="itemQty.Ash>0" class="print-friendly">
                    <!-- <caption id="caption2">Ash Controls</caption> -->

                    <tr>
                        <th>QTY</th>
                        <th>Number Of Doors</th>
                        <th>Cooler / Freezer </th>
                        <th>110V / 220V </th>
                        <th>AMP </th>
                        <th>Notes</th>
                        <th>Price</th>
                        <th>Total</th>
                    </tr>

                    <tr ng-repeat="line in lineArr" ng-if="lineArr[$index].name=='Ash'">
                        <td>{{ lineArr[$index].idqty }}</td>
                        <td>{{ lineArr[$index].vuAsh }}</td>
                        <td>{{ lineArr[$index].vuCool }}</td>
                        <td>{{ lineArr[$index].vuSides }}</td>
                        <td>{{ lineArr[$index].vuAmp }}</td>
                        <td>{{ lineArr[$index].vuNote }}</td>
                        <td>${{ lineArr[$index].vuPrice }}</td>
                        <td>${{ lineArr[$index].vuPrice*lineArr[$index].idqty }}</td>
                    </tr>
                </table>
            </div>

            <!-- ------------------------ Curtain ---------------------------------- -->

            <div id="ashTable">
                
<br/>    
					<h3 ng-if="itemQty.Curtain>0"> Strip Curtains </h3>
        
<br/> 
                <table ng-if="itemQty.Curtain>0" class="print-friendly">
                    <!-- <caption id="caption2">Strip Curtains</caption> -->
                    <tr>
                        <th>QTY</th>
                        <th>Width</th>
                        <th>Height</th>
                        <th>Cooler / Freezer </th>
                        <th>Notes</th>
                        <th>Price</th>
                        <th>Total</th>
                    </tr>
                    <tr ng-repeat="line in lineArr" ng-if="lineArr[$index].name=='Curtain'">
                        <td>{{ lineArr[$index].idqty }}</td>
                        <td>{{ lineArr[$index].vuWidth }}</td>
                        <td>{{ lineArr[$index].vuHigh }}</td>
                        <td>{{ lineArr[$index].vuCool }}</td>
                        <td>{{ lineArr[$index].vuNote }}</td>
                        <td>${{ lineArr[$index].vuPrice }}</td>
                        <td>${{ lineArr[$index].vuPrice*lineArr[$index].idqty }}</td>
                    </tr>

                </table>
            </div>
            <!-- ------------------------ NC ---------------------------------- -->

            <div id="ashTable">
        
<br/>   
              <h3 ng-if="itemQty.NC>0"> Night Cover </h3>
        
<br/>   
                <table ng-if="itemQty.NC>0" class="print-friendly">
                    <!-- <caption id="caption2">Night Covers</caption> -->
                    <tr>
                        <th>QTY</th>
                        <th>3 ft /4 ft </th>
                        <th>Cooler / Freezer </th>
                        <th>Notes</th>
                        <th>Price</th>
                        <th>Total</th>
                    </tr>
                    <tr ng-repeat="line in lineArr" ng-if="lineArr[$index].name=='NC'">
                        <td>{{ lineArr[$index].idqty }}</td>
                        <td>{{ lineArr[$index].vuSides }}</td>
                        <td>{{ lineArr[$index].vuCool }}</td>
                        <td>{{ lineArr[$index].vuNote }}</td>
                        <td>${{ lineArr[$index].vuPrice }}</td>
                        <td>${{ lineArr[$index].vuPrice*lineArr[$index].idqty }}</td>
                    </tr>
                </table>
            </div>
            <!-- ------------------------ Gasket ---------------------------------- -->

            <div id="ashTable">
<br/>  
                 <h3 ng-if="itemQty.Gasket>0"> Gaskets </h3>
        
<br/>   
			
			   <table ng-if="itemQty.Gasket>0" class="print-friendly">
                    <!-- <caption id="caption2">Gaskets</caption> -->
                    <tr>
                        <th>QTY</th>
                        <th>Style</th>
                        <th>Width</th>
                        <th>Height</th>
                        <th>3 /4 sides </th>
                        <th>Walk-in / Reach-in </th>
                        <th>Cooler / Freezer </th>
                        <th>Notes</th>
                        <th>Price</th>
                        <th>Total</th>
                    </tr>
                    <tr ng-repeat="line in lineArr" ng-if="lineArr[$index].name=='Gasket'">
                        <td>{{ lineArr[$index].idqty }}</td>
                        <td>{{ lineArr[$index].vuStyle }}</td>
                        <td>{{ lineArr[$index].vuWidth }}</td>
                        <td>{{ lineArr[$index].vuHigh }}</td>
                        <td>{{ lineArr[$index].vuSides }}</td>
                        <td>{{ lineArr[$index].vuRiWi }}</td>
                        <td>{{ lineArr[$index].vuCool }}</td>
                        <td>{{ lineArr[$index].vuNote }}</td>
                        <td>${{ lineArr[$index].vuPrice }}</td>
                        <td>${{ lineArr[$index].vuPrice*lineArr[$index].idqty }}</td>
                    </tr>

                </table>
            </div>
            <!-- --------------- CLOSER  ------------------- -->
            <div id="ashTable">
        
<br/>   
                 
				 <h3 ng-if="itemQty.Closer>0"> Closer </h3> 
        
<br/>   
                <table ng-if="itemQty.Closer>0" class="print-friendly">
                    <!-- <caption id="caption2">Closer</caption> -->
                    <tr>
                        <th>QTY</th>
                        <th>Cooler / Freezer </th>
                        <th>Regular / Large </th>
                        <th>Notes</th>
                        <th>Price</th>
                        <th>Total</th>
                    </tr>
                    <tr ng-repeat="line in lineArr" ng-if="lineArr[$index].name=='Closer'">
                        <td>{{ lineArr[$index].idqty }}</td>
                        <td>{{ lineArr[$index].vuCool }}</td>
                        <td>{{ lineArr[$index].vuSides }}</td>
                        <td>{{ lineArr[$index].vuNote }}</td>
                        <td>${{ lineArr[$index].vuPrice }}</td>
                        <td>${{ lineArr[$index].vuPrice*lineArr[$index].idqty }}</td>
                    </tr>

                </table>
            </div>
            <!-- ---------------------------------------------------------- -->
       
<br/>   
            <h3>Total: ${{ totalWOcost }}</h3>
            <h4 style="margin:1px;">Parts and labor included.</h4>
            <br />
            <div class="customer-info-item">
               
                <div class="ex1" id="signDiv" style="overflow: hidden;" ng-init="SignInSVG()"  >
				 <div id="signature-pad" class="signature-pad">
						<div class="signature-pad--body">
						  <canvas  id="mycanvas" style="touch-action: none; user-select: none;width:100%;heght:100%" ></canvas>
						</div>
				</div>
				</div>

            </div>
            <div id='dec'  >
                <p class="declair">- Please make checks payable to E.B.E USA Inc.</p>
                <p class="declair">- Customer payment is due upon installation.</p>
                <p class="declair">- By signing this order I hereby agree to allow a representative access to this facility in order to preform a free post installation inspection.</p>
                <p class="declair">- By signing this order customer acknowledges that E.B.E. USA Inc. is a trade ally of the energy efficiency program and authorizes direct payment of incentives to be submitted to trade ally upon project completion.</p>
                <p class="declair">- I agree to pay any taxes applicable to this sale.</p>
                <p class="declair">- By signing this order I hereby acknowledge I have read and agreed to these terms.</p>
                <p class="declair">- Without your signature, we can not start the installation process.</p>
            </div>
             
        </div>
        
			</md-card>
    </div>

    </ng-switch>

    </ui-view>
    </md-content>
    </div>
    <script> 
        var Xtext = {};
        //------------------ 
        //---------------------
        var app = angular.module('StarterApp', ['ngMaterial', 'ngMdIcons', 'md.data.table']);

        app.controller('AppCtrl', ['$scope','$rootScope',  '$mdBottomSheet', '$mdSidenav', '$mdDialog', function ($scope,$rootScope, $mdBottomSheet, $mdSidenav, $mdDialog) {
         	  function resizeCanvas() {
				  
				  var wrapper = document.getElementById("signature-pad");
				  var canvas = wrapper.querySelector("canvas");
				  var ratio =  Math.max(window.devicePixelRatio || 1, 1); 
				  canvas.width = canvas.offsetWidth * ratio;
				  canvas.height = canvas.offsetHeight * ratio;
				  canvas.getContext("2d").scale(ratio, ratio);
				  var signaturePad = new SignaturePad(canvas, {
							backgroundColor: 'rgb(255, 255, 255)'
							});
				//  signaturePad.clear();
				}
				 $scope.SignInSVG=function(){
				 
						var wrapper = document.getElementById("signature-pad");
						var svgdiv = document.getElementById("signDiv");
						var canvas = wrapper.querySelector("canvas");
						var signaturePad = new SignaturePad(canvas, {
						backgroundColor: 'rgb(255, 255, 255)'
						});
						window.onresize = resizeCanvas;
						resizeCanvas();
						svgdiv.addEventListener("dblclick", function (event) {
								  signaturePad.clear();
								});
				} 
				 
			$scope.openMenu = function($mdMenu, ev) {
				  originatorEv = ev;
				  $mdMenu.open(ev);
				};

   		    $scope.selected = [];
			$scope.data = {
			selectedIndex: 0,
			secondLocked:  true};
            $scope.options = {
                boundaryLinks: true,
                rowSelection: true
            };

            $scope.query = {
                order: 'name',
                limit: 5,
                page: 1
            };
			$scope.toggleSidenav = function (menuId) {
                $mdSidenav(menuId).toggle();
            };
			$scope.printPrivewPage=function(){
					$("#myimg").remove();
					const canvas = document.getElementById('mycanvas')
					const img    = canvas.toDataURL('image/png');
					$(".signature-pad--body").append('<img src="'+img+'" id="myimg" style="width: 100%;"/>' );
					$("#mycanvas").hide();
						window.print();
						
					 $("#mycanvas").show();
					 $("#myimg").hide();
			}
			$scope.printPage=function(){ 
					 
    var HTML_Width = 1000 ;//$("#printArea").width();
    var HTML_Height = 2350;//$("#printArea").height();
    var top_left_margin = 15;
    var PDF_Width = HTML_Width + (top_left_margin * 2);
    var PDF_Height = (PDF_Width * 1.5) + (top_left_margin * 2);
    var canvas_image_width = HTML_Width;
    var canvas_image_height = HTML_Height;

    var totalPDFPages = Math.ceil(HTML_Height / PDF_Height) - 1;

    html2canvas($("#printArea")[0]).then(function (canvas) {
        var imgData = canvas.toDataURL("image/jpeg", 1.0);
        var pdf = new jsPDF('p', 'pt', [PDF_Width, PDF_Height]);
        pdf.addImage(imgData, 'JPG', top_left_margin, top_left_margin, canvas_image_width, canvas_image_height);
        for (var i = 1; i <= totalPDFPages; i++) { 
            pdf.addPage(PDF_Width, PDF_Height);
            pdf.addImage(imgData, 'JPG', top_left_margin, -(PDF_Height*i)+(top_left_margin*4),canvas_image_width,canvas_image_height);
        }
        pdf.save($scope.f_info.bv_name+'_print.pdf');
       // $("#printArea").hide();
    });
					
			}
		
		
		
		
			$scope.showSearch=false;
			$scope.Open=function(){ 
				document.getElementById('file').click();	 
			}
			
            $scope.pageToShow = "";
				$scope.userName = "";
				$scope.userPhone = "";
				$scope.userEmail = "";
            $scope.numOfLines = 1;
            $scope.woToLoad = [];
            $scope.filenames = [];
            $scope.fileSelector;
            $scope.totalWOcost = 0;
            $scope.lightOpt = ['Troffer', 'Panel', 'Canopy', 'Wrap', 'Strip', 'High-Bay', 'Shoe-Box', 'Flood', 'Wall-Pack', 'Cooler', 'Barn', 'Screw-In', 'Flash-Mount'];

$scope.ChangeuserName  = function(v){$scope.userName = v;   };
$scope.ChangeuserPhone = function(v){$scope.userPhone = v;   };
$scope.ChangeuserEmail = function(v){$scope.userEmail = v;   };

            $scope.initFormCustomer = function () {
			 
                b_name = "";
                f_date = "";
                b_address = "";
                b_city = "";
                b_state = "";
                b_zip = "";
                b_contact = "";
                b_title = "";
                b_phone = "";
                b_email = "";
                f_notes = "";
                $scope.f_info = { bv_name: b_name, fv_date: f_date, bv_address: b_address, bv_city: b_city, bv_state: b_state, bv_zip: b_zip, bv_contact: b_contact, bv_title: b_title, bv_phone: b_phone, bv_email: b_email, fv_notes: f_notes };
		   }

            $scope.initFormCustomer();
            tc = "line0";
            tf = "four0";
            ts = "four0";
            gcf = "cool0";
            ccf = "cool0";
            rcf = "cool0";
            acf = "cool0";
            ncf = "cool0";
            nm = "Gasket";
            idq = '';
            ids = 'style0';
            idw = 'width0';
            idh = 'high0';
            idtp = 'totalPrice0';

            ashn = 'ashNodoors0';
            lnprice = 'linePrice0';
            lnnote = 'lineNote0';
            valSides = '';  
            valCool = '';  
            valTotalPrice = "Total: $0";

            idExFxTy = 'ExFxTy0';
            idNwFxTy = 'NwFxTy0';
            idExLtTy = 'ExLtTy0';
            idNwLtTy = 'NwLtTy0';
            idColor = 'Color0';
            idNOL = 'NOL0';
            idType = 'Type0';
            idCurWt = 'CurWt0';
            idNewWt = 'NewWt0';
            idWorkLt = 'WorkLt0';
            idFxHigh = 'FxHigh0';

            valExFxTy = "Troffer";
            valNwFxTy = "Troffer";
            valExLtTy = "";
            valNwLtTy = "Troffer"
            valColor = "5000K";
            valNOL = "1";
            valType = "Fixture";
            valCurWt = "";
            valNewWt = "";
            valWorkLt = "";
            valFxHigh = "";

            idRiWi = "RiWi0";
            valRiWi = "";

            idAmp = "amp0";
            valAmp = "";

            $scope.lineArr = [{ id_Amp: idAmp, vuAmp: valAmp, id_RiWi: idRiWi, vuRiWi: valRiWi, id_NwLtTy: idNwLtTy, vuNwLtTy: valNwLtTy, idTotalPrice: idtp, setTotalPrice: valTotalPrice, vuExFxTy: valExFxTy, vuNwFxTy: valNwFxTy, vuExLtTy: valExLtTy, vuColor: valColor, vuNOL: valNOL, vuType: valType, vuCurWt: valCurWt, vuNewWt: valNewWt, vuWorkLt: valWorkLt, vuFxHigh: valFxHigh, id_ExFxTy: idExFxTy, id_NwFxTy: idNwFxTy, id_ExLtTy: idExLtTy, id_Color: idColor, id_NOL: idNOL, id_Type: idType, id_CurWt: idCurWt, id_NewWt: idNewWt, id_WorkLt: idWorkLt, id_FxHigh: idFxHigh, typeChs: tc, idqty: idq, name: nm, idashNodoors: ashn, aclFr: acf, idstyle: ids, vuStyle: "", idwidth: idw, vuWidth: "", idhigh: idh, vuHigh: "", sidesG: ts, gclFr: gcf, cclFr: ccf, rclFr: rcf, threeFour: tf, nclFr: ncf, idLineNote: lnnote, idLinePrice: lnprice, vuQty: 0, vuAsh: 0, vuPrice: 0, vuNote: "", vuSides: "", vuCool: "" }
             ];
            $scope.itemQty = { "Light": 0, "Ash": 0, "Curtain": 0, "NC": 0, "Gasket": 0, "Closer": 0 };
            $scope.makeTotalPrice = function (lineItem) {
                  priceVal = parseInt(lineItem.vuPrice);

                 qtyVal = parseInt(lineItem.idqty);

                if (priceVal && qtyVal) {
                    var totPR = priceVal * qtyVal;
                    lineItem.setTotalPrice = "Total: $" + totPR;
                }
                else {
                    lineItem.setTotalPrice = "Total: $0";
                }
            };

            $scope.returnNwLtArray = function (fixture) {
              
                switch (fixture) {
                    case 'Troffer':
                    case 'Panel':
                        return ['1x4', '2x2', '2x4']
                        break;
                    case 'Strip':
                    case 'Wrap':
                        return ['4ft', '8ft']
                        break;
                    case 'High-Bay':
                    case 'Wall-Pack':
                    case 'Flush-Mount':
                    case 'Flood':
                        return ['Bracket', 'Knuckle-mount']
                        break;
                    case 'Barn':
                        return ['n/a']
                        break;
                    case 'Screw-In':
                        return ['A19', 'BR40', 'BR30']
                        break;
                    case 'Shoe-Box':
                        return ['Direct-Arm', 'Slip-Fit']
                        break;
                    case 'Cooler':
                        return ['3ft', '4ft', '5ft', '6ft']
                        break;
                    case '':
                        return ['1x4', '2x2', '2x4']
                        break;

                }
            }
            $scope.NwtypeSelection = function (lnEX, lnLT, NewOld) {
                 if (document.getElementById(lnEX) && lnLT) {

                    theChs = document.getElementById(lnEX).value;

                    if (NewOld == 'Old') {
                        var optTpArray = $scope.returnLtArray(theChs);
                    }
                    else {
                        var optTpArray = $scope.returnNwLtArray(theChs);
                    }

                     temp = "";
                    for (opt of optTpArray) {

                        temp += ("<option value=" + opt + ">" + opt + "</option>")
                    }
                    document.getElementById(lnLT).innerHTML = temp;
                }
            }

            $scope.returnLtArray = function (fixture) {
                 switch (fixture) {
                    case 'Troffer':
                    case 'Panel':
                        return ['2x2', '2x4', '1x4']
                        break;
                    case 'Strip':
                        return ['4ft', '8ft']
                        break;
                    case 'Wrap':
                    case 'Cooler':
                    case 'Flush-Mount':
                        return ['T12', 'T8']
                        break;
                    case 'High-Bay':
                        return ['T12', 'T8', 'MH', 'HPS']
                        break;
                    case 'Screw-In':
                        return ['A19', 'CFL', 'BR40', 'BR30']
                        break;
                    case 'Wall-Pack':
                    case 'Shoe-Box':
                    case 'Flood':
                        return ['MH', 'HPS']
                        break;
                    case 'Barn':
                        return ['MH', 'HPS', 'A19', 'CFL']
                        break;
                    case '':
                        return ['T12', 'T8']
                        break;
                }
            }
		


            $scope.addLine = function (index) {

                
                tc = "line" + $scope.numOfLines;
                tf = "four" + $scope.numOfLines;
                ts = "four" + $scope.numOfLines;
                gcf = "cool" + $scope.numOfLines;
                ccf = "cool" + $scope.numOfLines;
                rcf = "cool" + $scope.numOfLines;
                acf = "cool" + $scope.numOfLines;
                ncf = "cool" + $scope.numOfLines;
                nm = "Gasket";
                idq = '';
                ids = 'style' + $scope.numOfLines;
                idw = 'width' + $scope.numOfLines;
                idh = 'high' + $scope.numOfLines;
                idtp = 'totalPrice' + $scope.numOfLines;

                ashn = 'ashNodoors' + $scope.numOfLines;
                lnprice = 'linePrice' + $scope.numOfLines;;
                lnnote = 'lineNote' + $scope.numOfLines;
                valSides = '';
                valCool = '';
                valTotalPrice = "Total: $0";

                idExFxTy = 'ExFxTy' + $scope.numOfLines;
                idNwFxTy = 'NwFxTy' + $scope.numOfLines;
                idExLtTy = 'ExLtTy' + $scope.numOfLines;
                idNwLtTy = 'NwLtTy' + $scope.numOfLines;
                idColor = 'Color' + $scope.numOfLines;
                idNOL = 'NOL' + $scope.numOfLines;
                idType = 'Type' + $scope.numOfLines;
                idCurWt = 'CurWt' + $scope.numOfLines;
                idNewWt = 'NewWt' + $scope.numOfLines;
                idWorkLt = 'WorkLt' + $scope.numOfLines;
                idFxHigh = 'FxHigh' + $scope.numOfLines;

                valExFxTy = "Troffer";
                valNwFxTy = "Troffer";
                valExLtTy = "";
                valNwLtTy = "Troffer"
                valColor = "5000K";
                valNOL = "1";
                valType = "Fixture";
                valCurWt = "";
                valNewWt = "";
                valWorkLt = "";
                valFxHigh = "";

                idRiWi = 'RiWi' + $scope.numOfLines;
                valRiWi = "";

                idAmp = "Amp" + $scope.numOfLines;
                valAmp = "";

                $scope.lineArr.splice(index + 1, 0, { id_Amp: idAmp, vuAmp: valAmp, id_RiWi: idRiWi, vuRiWi: valRiWi, id_NwLtTy: idNwLtTy, vuNwLtTy: valNwLtTy, idTotalPrice: idtp, setTotalPrice: valTotalPrice, vuExFxTy: valExFxTy, vuNwFxTy: valNwFxTy, vuExLtTy: valExLtTy, vuColor: valColor, vuNOL: valNOL, vuType: valType, vuCurWt: valCurWt, vuNewWt: valNewWt, vuWorkLt: valWorkLt, vuFxHigh: valFxHigh, id_ExFxTy: idExFxTy, id_NwFxTy: idNwFxTy, id_ExLtTy: idExLtTy, id_Color: idColor, id_NOL: idNOL, id_Type: idType, id_CurWt: idCurWt, id_NewWt: idNewWt, id_WorkLt: idWorkLt, id_FxHigh: idFxHigh, typeChs: tc, idqty: idq, name: nm, idashNodoors: ashn, aclFr: acf, idstyle: ids, vuStyle: "", idwidth: idw, vuWidth: "", idhigh: idh, vuHigh: "", sidesG: ts, gclFr: gcf, cclFr: ccf, rclFr: rcf, threeFour: tf, nclFr: ncf, idLineNote: lnnote, idLinePrice: lnprice, vuQty: 0, vuAsh: 0, vuPrice: 0, vuNote: "", vuSides: "", vuCool: "" });
                
                $scope.numOfLines += 1;
            };

            $scope.InitPage = function () {
                function compare(a, b) {
                    var rightOrder = ["Light", "Ash", "Curtain", "NC", "Gasket", "Closer"];
                    var indexA = rightOrder.indexOf(a.name);
                    var indexB = rightOrder.indexOf(b.name);
                    if (indexA < indexB) {
                        return -1;
                    }
                    if (indexA > indexB) {
                        return 1;
                    }
                    return 0;
                }
					
                    $scope.makeFileName();
                    $scope.totalWOcost = 0;
                     
                    for (line in $scope.lineArr) {
                          $scope.totalWOcost += $scope.lineArr[line].vuPrice * $scope.lineArr[line].idqty;
                    };
                    $scope.lineArr.sort(compare);
                    $scope.getLastLineNum();
                 
                $scope.itemQty = { "Light": 0, "Ash": 0, "Curtain": 0, "NC": 0, "Gasket": 0, "Closer": 0 };
                 
                for (line in $scope.lineArr) {
                     switch ($scope.lineArr[line].name) {
                        case 'Light':
                            $scope.itemQty["Light"] += 1;
                             break;
                        case 'Ash':
                            $scope.itemQty["Ash"] += 1;
                            break;
                        case 'Curtain':
                            $scope.itemQty["Curtain"] += 1;
                             break;
                        case 'NC':
                            $scope.itemQty["NC"] += 1;
                            break;
                        case 'Gasket':
                            $scope.itemQty["Gasket"] += 1;
                             break;
                        case 'Closer':
                            $scope.itemQty["Closer"] += 1;
                             break;

                    };
                };
            };
            $scope.newWoPage = function () {
                $scope.lineArr = [];
                $scope.initFormCustomer();
                $scope.addLine(0);
                $scope.setFN = "";
                $scope.numOfLines = 1; 
            };

            $scope.removeLine = function (index) { 
                if ($scope.lineArr.length > 1) {
                    $scope.lineArr.splice(index, 1);
                }

            };

            $scope.setFN = ""; 
            //------------------
            $scope.download = function (strFileName, strMimeType) {
                var strData = "";
                var D = document,
                    A = arguments,
                    a = D.createElement("a"),
                    //d = A[0],
                    n = A[0],
                    t = A[1] || "text/plain";
                text = "";
                text = JSON.stringify($scope.f_info);
              
                if (text != "[]") {
                    console.log('text is ' + text);
                }
                else {
                    $scope.initFormCustomer();
                    text = JSON.stringify($scope.f_info);
                    console.log('text is empty ' + text);
                }
                 
                text += "\n";
                 
                temp = JSON.stringify($scope.lineArr);
                strData = text + temp;
                $scope.woToLoad = text + temp;
                console.log('wo to load' + $scope.woToLoad);
                a.href = "data:" + strMimeType + "charset=utf-8," + escape(strData);


                if (window.MSBlobBuilder) { // IE10
                    var bb = new MSBlobBuilder();
                    bb.append(strData);
                     return navigator.msSaveBlob(bb, $scope.setFN);
                }  



                if ('download' in a) { 
                    a.setAttribute("download", n);
                    a.innerHTML = "downloading...";
                    D.body.appendChild(a);
                    setTimeout(function () {
                        var e = D.createEvent("MouseEvents");
                        e.initMouseEvent("click", true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);
                        a.dispatchEvent(e);
                        D.body.removeChild(a);
                    }, 66);
                    return true;
                };  
                var f = D.createElement("iframe");
                D.body.appendChild(f);
                f.src = "data:" + (A[2] ? A[2] : "application/octet-stream") + (window.btoa ? ";base64" : "") + "," + (window.btoa ? window.btoa : escape)(strData);
                setTimeout(function () {
                    D.body.removeChild(f);
                }, 333);
                return true;
            };  
 $scope.showPrompt = function (ev) {
    // Appending dialog to document.body to cover sidenav in docs app
    var confirm = $mdDialog.prompt()
      .title('Save')
      .textContent('Please Change File Name to Save:')
      .placeholder('File Name')
      .ariaLabel('File Name')
      .initialValue($scope.setFN)
      .targetEvent(ev)
      .required(true)
      .ok('Save')
      .cancel('Close');

    $mdDialog.show(confirm).then(function (result) {
      $scope.setFN =  result;
	  $scope.download($scope.setFN, 'text/plain');
    }, function () {
     // $scope.status = 'You didn\'t name your dog.';
    });
  };

            $scope.getLastLineNum = function () {
                var lNum = 1;
                for (line in $scope.lineArr) {
                    temp = $scope.lineArr[line].typeChs;
                    numb = temp.match(/\d/g);
                    numb = parseInt(numb.join(""));
                    if (lNum < numb) {
                        lNum = numb
                    }
                };
                $scope.numOfLines = parseInt(lNum) + 1;
                 
            }
           
            $scope.makeFileName = function () {
                bus_name = '';
                rep_name = 'OES_';
                
				if ($scope.f_info.bv_name) {
                    bus_name = $scope.f_info.bv_name;
                } else {
                     adres = "";
                };
                if ($scope.f_info.bv_address) {
                    adres = $scope.f_info.bv_address;
                } else {
                     adres = "";
                };

                if ($scope.userName) {
                    rep_name = $scope.userName;  
                }


                if (rep_name && bus_name) {
                    bus_name = bus_name.replace(/\s/g, '_').toLowerCase();
                    names = rep_name.split(' '),
                        initials = names[0].substring(0, 1).toUpperCase();

                    if (names.length > 1 && names[1]) {
                        initials += names[1].substring(0, 1).toUpperCase();
                    }
                    else {
                        if (rep_name.length > 1) {
                            initials = names[0].substring(0, 2).toUpperCase();
                        }
                    }
                    if (adres) {
                        splitAddress = adres.split(' ');
                        adres = splitAddress[0]
                    }
                    $scope.setFN = initials + "_" + bus_name + "_" + adres + ".txt";
                }
                else {
                    $scope.setFN = "Please_Update_Business_Name_Address_and_Rep.txt"
                };

            };
           	function FillForm(Xtext){
								$scope.lineArr = [];
								$scope.f_info = Xtext.f_info;
								$scope.lineArr=Xtext.lineArr;
								$scope.getLastLineNum();
								$scope.InitPage();
								  									 
				}
            $scope.openFile = function (event) {
                var input = event.target;
                var reader = new FileReader();
                reader.onload = function ($scope) {
                    var text = reader.result;                     
                    Xtext = JSON.parse('{"f_info":' + text.replace('}', '},"lineArr":') + '}');				
					FillForm(Xtext);
				 
                };
                reader.readAsText(input.files[0]);
            };

        }]);

         
        app.config(function ($mdThemingProvider,$mdGestureProvider) {
		 $mdGestureProvider.skipClickHijack();
         $mdGestureProvider.setMaxClickDistance(12);
         var customBlueMap = $mdThemingProvider.extendPalette('light-blue', {
                'contrastDefaultColor': 'light',
                'contrastDarkColors': ['50'],
                '50': 'ffffff'
            });
            $mdThemingProvider.definePalette('customBlue', customBlueMap);
            $mdThemingProvider.theme('default')
                .primaryPalette('customBlue', {
                    'default': '500',
                    'hue-1': '50'
                })
                .accentPalette('pink');
            $mdThemingProvider.theme('input', 'default')
                .primaryPalette('grey')
        });
	 
	 
    </script>
</body>

</html>
